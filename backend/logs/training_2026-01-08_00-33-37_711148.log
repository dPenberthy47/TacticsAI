2026-01-08 00:33:38.804 | INFO     | __main__:main:320 - ============================================================
2026-01-08 00:33:38.804 | INFO     | __main__:main:321 - TacticsAI Training
2026-01-08 00:33:38.804 | INFO     | __main__:main:322 - ============================================================
2026-01-08 00:33:38.804 | INFO     | __main__:main:323 - Arguments: {'epochs': 10, 'batch_size': 32, 'lr': 0.001, 'patience': 10, 'max_matches': 100, 'val_split': 0.2, 'synthetic': False, 'synthetic_samples': 1000, 'hidden_dim': 64, 'num_layers': 3, 'simple_model': False, 'model_path': 'backend/models/saved/tacticsai.pt', 'no_save': False}
2026-01-08 00:33:38.804 | INFO     | __main__:load_data:140 - ============================================================
2026-01-08 00:33:38.804 | INFO     | __main__:load_data:141 - Loading data...
2026-01-08 00:33:38.804 | INFO     | __main__:load_data:147 - Loading from StatsBomb open data
2026-01-08 00:33:38.804 | INFO     | data.dataset:from_statsbomb:195 - Loading StatsBomb data (competition=2, season=27)
2026-01-08 00:33:38.804 | DEBUG    | data.fetchers:__init__:53 - Initialized StatsBombFetcher with cache at backend/data/cache
2026-01-08 00:33:38.838 | INFO     | data.fetchers:_get_cached:125 - Cache hit for matches_2_27 (380 rows)
2026-01-08 00:33:38.838 | INFO     | data.dataset:from_statsbomb:210 - Processing 100 matches
2026-01-08 00:33:38.839 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754058
2026-01-08 00:33:38.841 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754245
2026-01-08 00:33:38.842 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754136
2026-01-08 00:33:38.844 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754037
2026-01-08 00:33:38.845 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754039
2026-01-08 00:33:38.847 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754041
2026-01-08 00:33:38.848 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754042
2026-01-08 00:33:38.850 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754043
2026-01-08 00:33:38.851 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754045
2026-01-08 00:33:38.853 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754048
2026-01-08 00:33:38.854 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754049
2026-01-08 00:33:38.855 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754050
2026-01-08 00:33:38.856 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754052
2026-01-08 00:33:38.857 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754053
2026-01-08 00:33:38.859 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754055
2026-01-08 00:33:38.860 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754226
2026-01-08 00:33:38.861 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754014
2026-01-08 00:33:38.863 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754091
2026-01-08 00:33:38.864 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754135
2026-01-08 00:33:38.865 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754293
2026-01-08 00:33:38.867 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754339
2026-01-08 00:33:38.868 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754146
2026-01-08 00:33:38.869 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754347
2026-01-08 00:33:38.870 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754255
2026-01-08 00:33:38.871 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754278
2026-01-08 00:33:38.873 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753979
2026-01-08 00:33:38.874 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753972
2026-01-08 00:33:38.875 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753978
2026-01-08 00:33:38.876 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753974
2026-01-08 00:33:38.878 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753993
2026-01-08 00:33:38.879 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753983
2026-01-08 00:33:38.880 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754015
2026-01-08 00:33:38.882 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754038
2026-01-08 00:33:38.883 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754001
2026-01-08 00:33:38.884 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754007
2026-01-08 00:33:38.885 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754008
2026-01-08 00:33:38.887 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754029
2026-01-08 00:33:38.888 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753995
2026-01-08 00:33:38.889 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753999
2026-01-08 00:33:38.890 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754017
2026-01-08 00:33:38.892 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754006
2026-01-08 00:33:38.893 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754023
2026-01-08 00:33:38.894 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753984
2026-01-08 00:33:38.895 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754011
2026-01-08 00:33:38.896 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754010
2026-01-08 00:33:38.898 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754028
2026-01-08 00:33:38.899 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753996
2026-01-08 00:33:38.900 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754025
2026-01-08 00:33:38.902 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754068
2026-01-08 00:33:38.903 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754056
2026-01-08 00:33:38.904 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754040
2026-01-08 00:33:38.905 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754074
2026-01-08 00:33:38.906 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754076
2026-01-08 00:33:38.908 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754067
2026-01-08 00:33:38.909 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754079
2026-01-08 00:33:38.910 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754090
2026-01-08 00:33:38.912 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754083
2026-01-08 00:33:38.913 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754077
2026-01-08 00:33:38.914 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754060
2026-01-08 00:33:38.916 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754073
2026-01-08 00:33:38.917 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754085
2026-01-08 00:33:38.918 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754047
2026-01-08 00:33:38.920 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754051
2026-01-08 00:33:38.921 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754093
2026-01-08 00:33:38.922 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754046
2026-01-08 00:33:38.924 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754072
2026-01-08 00:33:38.925 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754082
2026-01-08 00:33:38.926 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754106
2026-01-08 00:33:38.928 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754099
2026-01-08 00:33:38.929 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754098
2026-01-08 00:33:38.930 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754057
2026-01-08 00:33:38.931 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754112
2026-01-08 00:33:38.933 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754117
2026-01-08 00:33:38.934 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754104
2026-01-08 00:33:38.935 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754054
2026-01-08 00:33:38.936 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754113
2026-01-08 00:33:38.938 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754107
2026-01-08 00:33:38.939 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754105
2026-01-08 00:33:38.940 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754097
2026-01-08 00:33:38.941 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754102
2026-01-08 00:33:38.942 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754115
2026-01-08 00:33:38.944 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754148
2026-01-08 00:33:38.945 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754169
2026-01-08 00:33:38.946 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754174
2026-01-08 00:33:38.947 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754185
2026-01-08 00:33:38.948 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754162
2026-01-08 00:33:38.950 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754096
2026-01-08 00:33:38.951 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754171
2026-01-08 00:33:38.952 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754119
2026-01-08 00:33:38.953 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754126
2026-01-08 00:33:38.955 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754133
2026-01-08 00:33:38.956 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754167
2026-01-08 00:33:38.957 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754145
2026-01-08 00:33:38.958 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754153
2026-01-08 00:33:38.960 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754143
2026-01-08 00:33:38.961 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754186
2026-01-08 00:33:38.962 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754130
2026-01-08 00:33:38.963 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754188
2026-01-08 00:33:38.964 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754178
2026-01-08 00:33:38.965 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754157
2026-01-08 00:33:38.966 | INFO     | data.dataset:from_statsbomb:227 - Created 100 matchups from StatsBomb data
2026-01-08 00:33:38.966 | INFO     | data.dataset:__init__:155 - MatchupDataset initialized with 100 samples
2026-01-08 00:33:38.967 | INFO     | data.dataset:split:529 - Split: 80 train, 20 val
2026-01-08 00:33:38.967 | INFO     | data.dataset:__init__:155 - MatchupDataset initialized with 80 samples
2026-01-08 00:33:38.967 | INFO     | data.dataset:__init__:155 - MatchupDataset initialized with 20 samples
2026-01-08 00:33:38.967 | INFO     | __main__:load_data:161 - Train samples: 80
2026-01-08 00:33:38.967 | INFO     | __main__:load_data:162 - Val samples: 20
2026-01-08 00:33:38.967 | INFO     | __main__:create_model:181 - ============================================================
2026-01-08 00:33:38.967 | INFO     | __main__:create_model:182 - Creating model...
2026-01-08 00:33:38.967 | INFO     | __main__:create_model:191 - Using TacticsGNN
2026-01-08 00:33:39.005 | INFO     | __main__:create_model:200 - Model parameters: 36,747
2026-01-08 00:33:39.005 | INFO     | __main__:train_model:207 - ============================================================
2026-01-08 00:33:39.005 | INFO     | __main__:train_model:208 - Starting training...
2026-01-08 00:33:39.014 | INFO     | models.trainer:get_device:158 - Using Apple Silicon MPS
2026-01-08 00:33:39.029 | INFO     | models.trainer:__init__:207 - Model has 36,747 trainable parameters
2026-01-08 00:33:39.029 | INFO     | models.trainer:__init__:247 - TacticsTrainer initialized | device=mps | epochs=10
2026-01-08 00:33:39.029 | INFO     | models.trainer:train:587 - ============================================================
2026-01-08 00:33:39.029 | INFO     | models.trainer:train:588 - Starting training
2026-01-08 00:33:39.029 | INFO     | models.trainer:train:589 -   Epochs: 10
2026-01-08 00:33:39.029 | INFO     | models.trainer:train:590 -   Patience: 10
2026-01-08 00:33:39.029 | INFO     | models.trainer:train:591 -   Learning rate: 0.001
2026-01-08 00:33:39.029 | INFO     | models.trainer:train:592 -   Device: mps
2026-01-08 00:33:39.029 | INFO     | models.trainer:train:593 - ============================================================
2026-01-08 00:33:39.049 | ERROR    | __main__:main:351 - Training failed: stack expects each tensor to be equal size, but got [32] at entry 0 and [32, 9] at entry 1
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/scripts/train.py", line 356, in <module>
    sys.exit(main())
    │   │    └ <function main at 0x132b0b950>
    │   └ <built-in function exit>
    └ <module 'sys' (built-in)>

> File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/scripts/train.py", line 336, in main
    trainer, history = train_model(args, model, train_loader, val_loader)
                       │           │     │      │             └ <torch_geometric.loader.dataloader.DataLoader object at 0x132ae1d10>
                       │           │     │      └ <torch_geometric.loader.dataloader.DataLoader object at 0x1329778c0>
                       │           │     └ TacticsGNN(
                       │           │         (input_proj): Linear(in_features=8, out_features=64, bias=True)
                       │           │         (gcn_layers): ModuleList(
                       │           │           (0-2): 3 x GCNC...
                       │           └ Namespace(epochs=10, batch_size=32, lr=0.001, patience=10, max_matches=100, val_split=0.2, synthetic=False, synthetic_samples...
                       └ <function train_model at 0x132b0a2a0>

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/scripts/train.py", line 227, in train_model
    history = trainer.train()
              │       └ <function TacticsTrainer.train at 0x132b0b270>
              └ <models.trainer.TacticsTrainer object at 0x134c4c1a0>

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/models/trainer.py", line 602, in train
    train_metrics = self.train_epoch()
                    │    └ <function TacticsTrainer.train_epoch at 0x132b0ac40>
                    └ <models.trainer.TacticsTrainer object at 0x134c4c1a0>

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/models/trainer.py", line 413, in train_epoch
    labels = torch.stack(labels).to(self.device) if isinstance(labels, list) else labels.to(self.device)
             │     │     │          │    │                     │                  │         │    └ device(type='mps')
             │     │     │          │    │                     │                  │         └ <models.trainer.TacticsTrainer object at 0x134c4c1a0>
             │     │     │          │    │                     │                  └ [tensor([0.5000, 1.0000, 1.0000, 0.5000, 1.0000, 0.5000, 1.0000, 0.5000, 0.0000,
             │     │     │          │    │                     │                            1.0000, 0.5000, 1.0000, 0.0000, 0.50...
             │     │     │          │    │                     └ [tensor([0.5000, 1.0000, 1.0000, 0.5000, 1.0000, 0.5000, 1.0000, 0.5000, 0.0000,
             │     │     │          │    │                               1.0000, 0.5000, 1.0000, 0.0000, 0.50...
             │     │     │          │    └ device(type='mps')
             │     │     │          └ <models.trainer.TacticsTrainer object at 0x134c4c1a0>
             │     │     └ [tensor([0.5000, 1.0000, 1.0000, 0.5000, 1.0000, 0.5000, 1.0000, 0.5000, 0.0000,
             │     │               1.0000, 0.5000, 1.0000, 0.0000, 0.50...
             │     └ <built-in method stack of type object at 0x108fef5b8>
             └ <module 'torch' from '/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/venv/lib/python3.14/site-packag...

RuntimeError: stack expects each tensor to be equal size, but got [32] at entry 0 and [32, 9] at entry 1
