2026-01-08 00:35:53.048 | INFO     | __main__:main:320 - ============================================================
2026-01-08 00:35:53.048 | INFO     | __main__:main:321 - TacticsAI Training
2026-01-08 00:35:53.048 | INFO     | __main__:main:322 - ============================================================
2026-01-08 00:35:53.048 | INFO     | __main__:main:323 - Arguments: {'epochs': 10, 'batch_size': 32, 'lr': 0.001, 'patience': 10, 'max_matches': 100, 'val_split': 0.2, 'synthetic': False, 'synthetic_samples': 1000, 'hidden_dim': 64, 'num_layers': 3, 'simple_model': False, 'model_path': 'backend/models/saved/tacticsai.pt', 'no_save': False}
2026-01-08 00:35:53.048 | INFO     | __main__:load_data:140 - ============================================================
2026-01-08 00:35:53.048 | INFO     | __main__:load_data:141 - Loading data...
2026-01-08 00:35:53.048 | INFO     | __main__:load_data:147 - Loading from StatsBomb open data
2026-01-08 00:35:53.048 | INFO     | data.dataset:from_statsbomb:195 - Loading StatsBomb data (competition=2, season=27)
2026-01-08 00:35:53.048 | DEBUG    | data.fetchers:__init__:53 - Initialized StatsBombFetcher with cache at backend/data/cache
2026-01-08 00:35:53.081 | INFO     | data.fetchers:_get_cached:125 - Cache hit for matches_2_27 (380 rows)
2026-01-08 00:35:53.081 | INFO     | data.dataset:from_statsbomb:210 - Processing 100 matches
2026-01-08 00:35:53.081 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754058
2026-01-08 00:35:53.083 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754245
2026-01-08 00:35:53.084 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754136
2026-01-08 00:35:53.086 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754037
2026-01-08 00:35:53.088 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754039
2026-01-08 00:35:53.089 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754041
2026-01-08 00:35:53.090 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754042
2026-01-08 00:35:53.092 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754043
2026-01-08 00:35:53.093 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754045
2026-01-08 00:35:53.094 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754048
2026-01-08 00:35:53.096 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754049
2026-01-08 00:35:53.097 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754050
2026-01-08 00:35:53.098 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754052
2026-01-08 00:35:53.099 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754053
2026-01-08 00:35:53.100 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754055
2026-01-08 00:35:53.102 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754226
2026-01-08 00:35:53.103 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754014
2026-01-08 00:35:53.104 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754091
2026-01-08 00:35:53.106 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754135
2026-01-08 00:35:53.107 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754293
2026-01-08 00:35:53.108 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754339
2026-01-08 00:35:53.109 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754146
2026-01-08 00:35:53.110 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754347
2026-01-08 00:35:53.112 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754255
2026-01-08 00:35:53.113 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754278
2026-01-08 00:35:53.114 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753979
2026-01-08 00:35:53.116 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753972
2026-01-08 00:35:53.117 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753978
2026-01-08 00:35:53.118 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753974
2026-01-08 00:35:53.119 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753993
2026-01-08 00:35:53.121 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753983
2026-01-08 00:35:53.122 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754015
2026-01-08 00:35:53.123 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754038
2026-01-08 00:35:53.124 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754001
2026-01-08 00:35:53.126 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754007
2026-01-08 00:35:53.127 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754008
2026-01-08 00:35:53.128 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754029
2026-01-08 00:35:53.130 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753995
2026-01-08 00:35:53.131 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753999
2026-01-08 00:35:53.132 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754017
2026-01-08 00:35:53.134 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754006
2026-01-08 00:35:53.135 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754023
2026-01-08 00:35:53.136 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753984
2026-01-08 00:35:53.137 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754011
2026-01-08 00:35:53.138 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754010
2026-01-08 00:35:53.139 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754028
2026-01-08 00:35:53.141 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3753996
2026-01-08 00:35:53.142 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754025
2026-01-08 00:35:53.143 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754068
2026-01-08 00:35:53.144 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754056
2026-01-08 00:35:53.146 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754040
2026-01-08 00:35:53.147 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754074
2026-01-08 00:35:53.148 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754076
2026-01-08 00:35:53.149 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754067
2026-01-08 00:35:53.151 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754079
2026-01-08 00:35:53.152 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754090
2026-01-08 00:35:53.153 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754083
2026-01-08 00:35:53.154 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754077
2026-01-08 00:35:53.156 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754060
2026-01-08 00:35:53.157 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754073
2026-01-08 00:35:53.158 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754085
2026-01-08 00:35:53.160 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754047
2026-01-08 00:35:53.161 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754051
2026-01-08 00:35:53.162 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754093
2026-01-08 00:35:53.163 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754046
2026-01-08 00:35:53.165 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754072
2026-01-08 00:35:53.166 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754082
2026-01-08 00:35:53.167 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754106
2026-01-08 00:35:53.169 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754099
2026-01-08 00:35:53.170 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754098
2026-01-08 00:35:53.171 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754057
2026-01-08 00:35:53.173 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754112
2026-01-08 00:35:53.174 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754117
2026-01-08 00:35:53.175 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754104
2026-01-08 00:35:53.176 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754054
2026-01-08 00:35:53.178 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754113
2026-01-08 00:35:53.179 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754107
2026-01-08 00:35:53.180 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754105
2026-01-08 00:35:53.181 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754097
2026-01-08 00:35:53.183 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754102
2026-01-08 00:35:53.184 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754115
2026-01-08 00:35:53.185 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754148
2026-01-08 00:35:53.186 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754169
2026-01-08 00:35:53.187 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754174
2026-01-08 00:35:53.189 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754185
2026-01-08 00:35:53.190 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754162
2026-01-08 00:35:53.191 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754096
2026-01-08 00:35:53.192 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754171
2026-01-08 00:35:53.193 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754119
2026-01-08 00:35:53.195 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754126
2026-01-08 00:35:53.196 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754133
2026-01-08 00:35:53.197 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754167
2026-01-08 00:35:53.199 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754145
2026-01-08 00:35:53.200 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754153
2026-01-08 00:35:53.201 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754143
2026-01-08 00:35:53.202 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754186
2026-01-08 00:35:53.203 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754130
2026-01-08 00:35:53.205 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754188
2026-01-08 00:35:53.206 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754178
2026-01-08 00:35:53.207 | INFO     | data.fetchers:fetch_lineups:302 - Cache hit for lineups 3754157
2026-01-08 00:35:53.208 | INFO     | data.dataset:from_statsbomb:227 - Created 100 matchups from StatsBomb data
2026-01-08 00:35:53.208 | INFO     | data.dataset:__init__:155 - MatchupDataset initialized with 100 samples
2026-01-08 00:35:53.208 | INFO     | data.dataset:split:529 - Split: 80 train, 20 val
2026-01-08 00:35:53.208 | INFO     | data.dataset:__init__:155 - MatchupDataset initialized with 80 samples
2026-01-08 00:35:53.208 | INFO     | data.dataset:__init__:155 - MatchupDataset initialized with 20 samples
2026-01-08 00:35:53.208 | INFO     | __main__:load_data:161 - Train samples: 80
2026-01-08 00:35:53.208 | INFO     | __main__:load_data:162 - Val samples: 20
2026-01-08 00:35:53.208 | INFO     | __main__:create_model:181 - ============================================================
2026-01-08 00:35:53.208 | INFO     | __main__:create_model:182 - Creating model...
2026-01-08 00:35:53.208 | INFO     | __main__:create_model:191 - Using TacticsGNN
2026-01-08 00:35:53.247 | INFO     | __main__:create_model:200 - Model parameters: 36,747
2026-01-08 00:35:53.248 | INFO     | __main__:train_model:207 - ============================================================
2026-01-08 00:35:53.248 | INFO     | __main__:train_model:208 - Starting training...
2026-01-08 00:35:53.259 | INFO     | models.trainer:get_device:158 - Using Apple Silicon MPS
2026-01-08 00:35:53.274 | INFO     | models.trainer:__init__:207 - Model has 36,747 trainable parameters
2026-01-08 00:35:53.274 | INFO     | models.trainer:__init__:247 - TacticsTrainer initialized | device=mps | epochs=10
2026-01-08 00:35:53.274 | INFO     | models.trainer:train:597 - ============================================================
2026-01-08 00:35:53.275 | INFO     | models.trainer:train:598 - Starting training
2026-01-08 00:35:53.275 | INFO     | models.trainer:train:599 -   Epochs: 10
2026-01-08 00:35:53.275 | INFO     | models.trainer:train:600 -   Patience: 10
2026-01-08 00:35:53.275 | INFO     | models.trainer:train:601 -   Learning rate: 0.001
2026-01-08 00:35:53.275 | INFO     | models.trainer:train:602 -   Device: mps
2026-01-08 00:35:53.275 | INFO     | models.trainer:train:603 - ============================================================
2026-01-08 00:35:58.922 | ERROR    | __main__:main:351 - Training failed: 'list' object has no attribute 'to'
Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/scripts/train.py", line 356, in <module>
    sys.exit(main())
    │   │    └ <function main at 0x12130f950>
    │   └ <built-in function exit>
    └ <module 'sys' (built-in)>

> File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/scripts/train.py", line 336, in main
    trainer, history = train_model(args, model, train_loader, val_loader)
                       │           │     │      │             └ <torch_geometric.loader.dataloader.DataLoader object at 0x1212e9bd0>
                       │           │     │      └ <torch_geometric.loader.dataloader.DataLoader object at 0x12117b8c0>
                       │           │     └ TacticsGNN(
                       │           │         (input_proj): Linear(in_features=8, out_features=64, bias=True)
                       │           │         (gcn_layers): ModuleList(
                       │           │           (0-2): 3 x GCNC...
                       │           └ Namespace(epochs=10, batch_size=32, lr=0.001, patience=10, max_matches=100, val_split=0.2, synthetic=False, synthetic_samples...
                       └ <function train_model at 0x12130e2a0>

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/scripts/train.py", line 227, in train_model
    history = trainer.train()
              │       └ <function TacticsTrainer.train at 0x12130f270>
              └ <models.trainer.TacticsTrainer object at 0x121ed01a0>

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/models/trainer.py", line 615, in train
    val_metrics = self.validate()
                  │    └ <function TacticsTrainer.validate at 0x12130f110>
                  └ <models.trainer.TacticsTrainer object at 0x121ed01a0>

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/venv/lib/python3.14/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           │     │       └ {}
           │     └ (<models.trainer.TacticsTrainer object at 0x121ed01a0>,)
           └ <function TacticsTrainer.validate at 0x12130f060>

  File "/Users/adrianapenberthy/Documents/AIPM/PythonProjects/TacticsAI/backend/models/trainer.py", line 547, in validate
    labels = labels.to(self.device)
             │         │    └ device(type='mps')
             │         └ <models.trainer.TacticsTrainer object at 0x121ed01a0>
             └ [tensor([0.5000, 0.0000, 1.0000, 1.0000, 0.0000, 0.0000, 1.0000, 0.5000, 0.5000,
                       0.0000, 0.5000, 0.0000, 0.0000, 0.00...

AttributeError: 'list' object has no attribute 'to'
